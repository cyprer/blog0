# redolog

## 对于部分写失效问题
  redolog能做到的是,未将缓冲池中的脏页刷盘就发生宕机了,此时innodb可以在服务重启时根据redolog中的日志进行回滚,将脏页刷盘.但是,当脏页开始刷盘时,但并没有完全刷盘完成就宕机,这种情况叫部分写失效,redolog就无法在服务重启ship时将redolog中的日志进行回滚,将脏页刷盘,因为磁盘的脏页是不完整的,失效的,无法进行回滚.此时就需要双写机制解决部分写失效问题.
## 双写机制
  1. 拷贝完整脏页到双写缓冲区
  2. 将双写缓冲区中的脏页顺序写到共享表空间里的双写区,并调用fsync()强制同步到磁盘
  3. 然后进行正常的脏页刷盘
  4. 如果发生了部分写失效,innodb会找到损坏页对应的双写区副本并覆盖损坏页,接着加载到缓冲池中进行后续修改,接着继续刷盘
